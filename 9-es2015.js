(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"99Un":function(t,e,i){"use strict";i.r(e),i.d(e,"HomeModule",(function(){return M}));var n=i("tyNb"),a=i("M0ag"),c=i("fXoL"),r=i("tk/3");let o=(()=>{class t{constructor(t){this.http=t,this.dataUrl="https://data.sfgov.org/resource/rqzj-sfat.json"}getFoodTruckData(t){return this.http.get(this.dataUrl,{params:t})}}return t.\u0275fac=function(e){return new(e||t)(c.Vb(r.a))},t.\u0275prov=c.Hb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var s=i("LRne"),l=i("UXun"),d=i("vkgz"),b=i("nYR2"),m=i("pD6V"),u=i("XhcP"),g=i("ofXK"),f=i("Wp6s"),h=i("bTqV"),p=i("Qu3c"),k=i("pxUr"),v=i("Xa2L");function O(t,e){1&t&&c.Mb(0,"mat-spinner",14),2&t&&c.hc("diameter",22)("strokeWidth",2)}function R(t,e){1&t&&c.Mb(0,"mat-spinner",15),2&t&&c.hc("diameter",22)("strokeWidth",2)}function C(t,e){if(1&t){const t=c.Sb();c.Rb(0,"agm-marker",17),c.Zb("markerClick",(function(){c.pc(t);const i=e.$implicit;return c.cc(2).markerClicked(i)})),c.Rb(1,"agm-info-window",18),c.Rb(2,"strong"),c.zc(3),c.Qb(),c.Rb(4,"p"),c.zc(5),c.Qb(),c.Qb(),c.Qb()}if(2&t){const t=e.$implicit,i=c.cc(2);c.hc("latitude",t.latitude)("longitude",t.longitude)("label",t.label),c.Ab(1),c.hc("isOpen",i.infoWindow===t.objectid),c.Ab(2),c.Ac(t.applicant),c.Ab(2),c.Ac(t.address)}}function Q(t,e){if(1&t&&(c.Pb(0),c.xc(1,C,6,6,"agm-marker",16),c.Ob()),2&t){const t=e.ngIf;c.Ab(1),c.hc("ngForOf",t)}}function y(t,e){if(1&t&&c.Mb(0,"agm-circle",19),2&t){const t=c.cc();c.hc("latitude",t.lat)("longitude",t.lng)("radius",t.radius)("clickable",!1)("fillColor","blue")("fillOpacity",.2)}}function w(t,e){1&t&&c.Mb(0,"div")}function I(t,e){if(1&t){const t=c.Sb();c.Rb(0,"div",21),c.Rb(1,"div",22),c.Zb("click",(function(){c.pc(t);const i=e.$implicit;return c.cc(3).markerClicked(i)})),c.Rb(2,"mat-card"),c.Rb(3,"mat-card-title"),c.zc(4),c.Qb(),c.Rb(5,"mat-card-subtitle"),c.zc(6),c.Qb(),c.Rb(7,"mat-card-content"),c.Rb(8,"strong"),c.zc(9,"Distance:"),c.Qb(),c.zc(10),c.Qb(),c.Rb(11,"mat-card-actions"),c.Rb(12,"a",23),c.zc(13," Click for Directions "),c.Qb(),c.Qb(),c.Qb(),c.Qb(),c.Qb()}if(2&t){const t=e.$implicit,i=c.cc(3);c.Ab(1),c.Cb("p-2 ",t===i.selectedMarker?"bg-secondary":"",""),c.Ab(3),c.Cc(" ",t.label,") ",t.applicant," "),c.Ab(2),c.Bc(" ",t.address," "),c.Ab(4),c.Bc(" ",t.miles," miles "),c.Ab(2),c.ic("href","https://www.google.com/maps/dir/?api=1&origin=",i.lat,",",i.lng,"&destination=",t.latitude,",",t.longitude,"",c.qc)}}function x(t,e){if(1&t&&(c.Pb(0),c.xc(1,I,14,11,"div",20),c.Ob()),2&t){const t=e.ngIf;c.Ab(1),c.hc("ngForOf",t)}}function z(t,e){if(1&t&&(c.xc(0,x,2,1,"ng-container",10),c.dc(1,"async")),2&t){const t=c.cc();c.hc("ngIf",c.ec(1,1,t.markers$))}}let A=(()=>{class t{constructor(t,e,i){this.mediaObserver=t,this.sfDataService=e,this.cdRef=i,this.mediaObserver$=this.mediaObserver.asObservable(),this.reset()}reset(){this.lat=37.75923216518026,this.lng=-122.42079955329393,this.zoom=12,this.radius=0,this.sidenavOpen=!1,this.markers$=Object(s.a)([])}markerClicked(t){this.selectedMarker===t?(this.selectedMarker=null,this.infoWindow=null):(this.selectedMarker=t,this.infoWindow=t.objectid)}mapClicked(t){this.selectedMarker=null,this.radius=0,this.lat=t.latLng.lat(),this.lng=t.latLng.lng(),this.findNearbyFoodTrucks()}findMe(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude,this.cdRef.detectChanges()}):alert("Geolocation is not supported by this browser.")}findNearbyFoodTrucks(){this.loading=!0,this.sidenavOpen=!0,this.markers$=this.sfDataService.getFoodTruckData({$order:`distance_in_meters(location, 'POINT (${this.lng} ${this.lat})')`,$limit:5,$select:`*, distance_in_meters(location, 'POINT (${this.lng} ${this.lat})') AS range`}).pipe(Object(l.a)(1),Object(d.a)(t=>{t.forEach((t,e)=>{this.zoom=14,t.label=String.fromCharCode(65+e);const i=Number(t.range)+20;i>this.radius&&(this.radius=i),t.miles=(parseFloat(t.range)/1609.34).toFixed(3)})}),Object(b.a)(()=>{this.loading=!1}))}}return t.\u0275fac=function(e){return new(e||t)(c.Lb(m.g),c.Lb(o),c.Lb(c.h))},t.\u0275cmp=c.Fb({type:t,selectors:[["ftc-home"]],decls:29,vars:17,consts:[["autosize","",1,"sidenav-container"],["mode","side",1,"sidenav",3,"opened"],["class","mx-auto my-5 d-block",3,"diameter","strokeWidth",4,"ngIf","ngIfElse"],[1,"page-container"],[1,""],["mat-raised-button","","color","primary","matTooltip","Reset map to Initial State",1,"mx-2",3,"click"],["mat-raised-button","","color","primary","matTooltip","Use location services to find your current location",1,"mx-2",3,"click"],[1,"mx-2"],["class","mx-2",3,"diameter","strokeWidth",4,"ngIf"],[3,"latitude","longitude","zoom","usePanning","clickableIcons","zoomChange","mapClick"],[4,"ngIf"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity",4,"ngIf"],[4,"ngIf","ngIfThen"],["markerTemplate",""],[1,"mx-auto","my-5","d-block",3,"diameter","strokeWidth"],[1,"mx-2",3,"diameter","strokeWidth"],[3,"latitude","longitude","label","markerClick",4,"ngFor","ngForOf"],[3,"latitude","longitude","label","markerClick"],[3,"isOpen"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity"],["class","sidenav",4,"ngFor","ngForOf"],[1,"sidenav"],[3,"click"],["target","_blank",1,"text-primary",3,"href"]],template:function(t,e){if(1&t&&(c.Rb(0,"mat-drawer-container",0),c.Rb(1,"mat-drawer",1),c.xc(2,O,1,2,"mat-spinner",2),c.Qb(),c.Rb(3,"mat-drawer-content"),c.Rb(4,"div",3),c.Rb(5,"mat-card"),c.Rb(6,"mat-card-title"),c.zc(7,"San Francisco Food Trucks"),c.Qb(),c.Rb(8,"mat-card-subtitle"),c.zc(9," We'll find the five closest food trucks to you in San Francisco! To start, enable access to your device location or click your current position in the map. "),c.Qb(),c.Rb(10,"mat-card-subtitle"),c.Rb(11,"strong"),c.zc(12," The Reset button will set the map to Initial State. "),c.Qb(),c.Qb(),c.Rb(13,"mat-card-subtitle",4),c.Rb(14,"button",5),c.Zb("click",(function(){return e.reset()})),c.zc(15," Reset "),c.Qb(),c.Rb(16,"button",6),c.Zb("click",(function(){return e.findMe()})),c.zc(17," Find Me "),c.Qb(),c.Rb(18,"span",7),c.zc(19),c.Qb(),c.xc(20,R,1,2,"mat-spinner",8),c.Qb(),c.Rb(21,"mat-card-content"),c.Rb(22,"agm-map",9),c.Zb("zoomChange",(function(t){return e.zoom=t}))("mapClick",(function(t){return e.mapClicked(t)})),c.xc(23,Q,2,1,"ng-container",10),c.dc(24,"async"),c.xc(25,y,1,6,"agm-circle",11),c.Qb(),c.Qb(),c.Qb(),c.xc(26,w,1,0,"div",12),c.Qb(),c.Qb(),c.Qb(),c.xc(27,z,2,3,"ng-template",null,13,c.yc)),2&t){const t=c.nc(28);c.Ab(1),c.hc("opened",e.sidenavOpen&&e.mediaObserver.isActive("gt-sm")),c.Ab(1),c.hc("ngIf",e.loading)("ngIfElse",t),c.Ab(17),c.Cc(" Latitude: ",e.lat,", Longitude: ",e.lng," "),c.Ab(1),c.hc("ngIf",e.loading),c.Ab(2),c.hc("latitude",e.lat)("longitude",e.lng)("zoom",e.zoom)("usePanning",!0)("clickableIcons",!1),c.Ab(1),c.hc("ngIf",c.ec(24,15,e.markers$)),c.Ab(2),c.hc("ngIf",e.radius),c.Ab(1),c.hc("ngIf",e.mediaObserver.isActive("lt-md"))("ngIfThen",t)}},directives:[u.b,u.a,g.k,u.c,f.a,f.f,f.e,h.b,p.a,f.c,k.d,v.b,g.j,k.e,k.c,k.a,f.b],pipes:[g.b],styles:["[_nghost-%COMP%]{display:flex;flex:1}.page-container[_ngcontent-%COMP%]{margin:1em 0}agm-map[_ngcontent-%COMP%]{height:600px}.mat-progress-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}mat-drawer-container[_ngcontent-%COMP%]{flex:1}mat-drawer-container[_ngcontent-%COMP%]   mat-drawer.sidenav[_ngcontent-%COMP%]{width:300px}.sidenav[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin:.5em}"]}),t})(),M=(()=>{class t{}return t.\u0275mod=c.Jb({type:t}),t.\u0275inj=c.Ib({factory:function(e){return new(e||t)},imports:[[a.a,n.c.forChild([{path:"",component:A}])]]}),t})()}}]);