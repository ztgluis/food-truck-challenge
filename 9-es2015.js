(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"99Un":function(t,e,i){"use strict";i.r(e);var n=i("tyNb"),a=i("M0ag"),c=i("fXoL"),o=i("tk/3");let r=(()=>{class t{constructor(t){this.http=t,this.dataUrl="https://data.sfgov.org/resource/rqzj-sfat.json"}getFoodTruckData(t){return this.http.get(this.dataUrl,{params:t})}}return t.\u0275fac=function(e){return new(e||t)(c.Yb(o.a))},t.\u0275prov=c.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var s=i("LRne"),l=i("UXun"),d=i("vkgz"),b=i("nYR2"),m=i("pD6V"),u=i("XhcP"),g=i("ofXK"),f=i("Wp6s"),p=i("bTqV"),k=i("Qu3c"),h=i("pxUr"),C=i("Xa2L");function T(t,e){1&t&&c.Pb(0,"mat-spinner",14),2&t&&c.kc("diameter",22)("strokeWidth",2)}function v(t,e){1&t&&c.Pb(0,"mat-spinner",15),2&t&&c.kc("diameter",22)("strokeWidth",2)}function y(t,e){if(1&t){const t=c.Vb();c.Ub(0,"agm-marker",17),c.cc("markerClick",(function(i){c.sc(t);const n=e.$implicit;return c.fc(2).markerClicked(n)})),c.Ub(1,"agm-info-window",18),c.Ub(2,"strong"),c.Ac(3),c.Tb(),c.Ub(4,"p"),c.Ac(5),c.Tb(),c.Tb(),c.Tb()}if(2&t){const t=e.$implicit,i=c.fc(2);c.kc("latitude",t.latitude)("longitude",t.longitude)("label",t.label),c.Cb(1),c.kc("isOpen",i.infoWindow===t.objectid),c.Cb(2),c.Bc(t.applicant),c.Cb(2),c.Bc(t.address)}}function O(t,e){if(1&t&&(c.Sb(0),c.yc(1,y,6,6,"agm-marker",16),c.Rb()),2&t){const t=e.ngIf;c.Cb(1),c.kc("ngForOf",t)}}function U(t,e){if(1&t&&c.Pb(0,"agm-circle",19),2&t){const t=c.fc();c.kc("latitude",t.lat)("longitude",t.lng)("radius",t.radius)("clickable",!1)("fillColor","blue")("fillOpacity",.2)}}function w(t,e){1&t&&c.Pb(0,"div")}function I(t,e){if(1&t){const t=c.Vb();c.Ub(0,"div",21),c.Ub(1,"div",22),c.cc("click",(function(i){c.sc(t);const n=e.$implicit;return c.fc(3).markerClicked(n)})),c.Ub(2,"mat-card"),c.Ub(3,"mat-card-title"),c.Ac(4),c.Tb(),c.Ub(5,"mat-card-subtitle"),c.Ac(6),c.Tb(),c.Ub(7,"mat-card-content"),c.Ub(8,"strong"),c.Ac(9,"Distance:"),c.Tb(),c.Ac(10),c.Tb(),c.Ub(11,"mat-card-actions"),c.Ub(12,"a",23),c.Ac(13," Click for Directions "),c.Tb(),c.Tb(),c.Tb(),c.Tb(),c.Tb()}if(2&t){const t=e.$implicit,i=c.fc(3);c.Cb(1),c.Eb("p-2 ",t===i.selectedMarker?"bg-secondary":"",""),c.Cb(3),c.Dc(" ",t.label,") ",t.applicant," "),c.Cb(2),c.Cc(" ",t.address," "),c.Cb(4),c.Cc(" ",t.miles," miles "),c.Cb(2),c.lc("href","https://www.google.com/maps/dir/?api=1&origin=",i.lat,",",i.lng,"&destination=",t.latitude,",",t.longitude,"",c.tc)}}function x(t,e){if(1&t&&(c.Sb(0),c.yc(1,I,14,11,"div",20),c.Rb()),2&t){const t=e.ngIf;c.Cb(1),c.kc("ngForOf",t)}}function M(t,e){if(1&t&&(c.yc(0,x,2,1,"ng-container",10),c.gc(1,"async")),2&t){const t=c.fc();c.kc("ngIf",c.hc(1,1,t.markers$))}}let P=(()=>{class t{constructor(t,e,i){this.mediaObserver=t,this.sfDataService=e,this.cdRef=i,this.mediaObserver$=this.mediaObserver.asObservable(),this.reset()}reset(){this.lat=37.75923216518026,this.lng=-122.42079955329393,this.zoom=12,this.radius=0,this.sidenavOpen=!1,this.markers$=Object(s.a)([])}markerClicked(t){this.selectedMarker===t?(this.selectedMarker=null,this.infoWindow=null):(this.selectedMarker=t,this.infoWindow=t.objectid)}mapClicked(t){this.selectedMarker=null,this.radius=0,this.lat=t.coords.lat,this.lng=t.coords.lng,this.findNearbyFoodTrucks()}findMe(){navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{this.lat=t.coords.latitude,this.lng=t.coords.longitude,this.cdRef.detectChanges()}):alert("Geolocation is not supported by this browser.")}findNearbyFoodTrucks(){this.loading=!0,this.sidenavOpen=!0,this.markers$=this.sfDataService.getFoodTruckData({$order:`distance_in_meters(location, 'POINT (${this.lng} ${this.lat})')`,$limit:5,$select:`*, distance_in_meters(location, 'POINT (${this.lng} ${this.lat})') AS range`}).pipe(Object(l.a)(1),Object(d.a)(t=>{t.forEach((t,e)=>{this.zoom=14,t.label=String.fromCharCode(65+e);const i=Number(t.range)+20;i>this.radius&&(this.radius=i),t.miles=(parseFloat(t.range)/1609.34).toFixed(3)})}),Object(b.a)(()=>{this.loading=!1}))}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(m.g),c.Ob(r),c.Ob(c.h))},t.\u0275cmp=c.Ib({type:t,selectors:[["ftc-home"]],decls:29,vars:17,consts:[["autosize","",1,"sidenav-container"],["mode","side",1,"sidenav",3,"opened"],["class","mx-auto my-5 d-block",3,"diameter","strokeWidth",4,"ngIf","ngIfElse"],[1,"page-container"],[1,""],["mat-raised-button","","color","primary","matTooltip","Reset map to Initial State",1,"mx-2",3,"click"],["mat-raised-button","","color","primary","matTooltip","Use location services to find your current location",1,"mx-2",3,"click"],[1,"mx-2"],["class","mx-2",3,"diameter","strokeWidth",4,"ngIf"],[3,"latitude","longitude","zoom","usePanning","clickableIcons","zoomChange","mapClick"],[4,"ngIf"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity",4,"ngIf"],[4,"ngIf","ngIfThen"],["markerTemplate",""],[1,"mx-auto","my-5","d-block",3,"diameter","strokeWidth"],[1,"mx-2",3,"diameter","strokeWidth"],[3,"latitude","longitude","label","markerClick",4,"ngFor","ngForOf"],[3,"latitude","longitude","label","markerClick"],[3,"isOpen"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity"],["class","sidenav",4,"ngFor","ngForOf"],[1,"sidenav"],[3,"click"],["target","_blank",1,"text-primary",3,"href"]],template:function(t,e){if(1&t&&(c.Ub(0,"mat-drawer-container",0),c.Ub(1,"mat-drawer",1),c.yc(2,T,1,2,"mat-spinner",2),c.Tb(),c.Ub(3,"mat-drawer-content"),c.Ub(4,"div",3),c.Ub(5,"mat-card"),c.Ub(6,"mat-card-title"),c.Ac(7,"San Francisco Food Trucks"),c.Tb(),c.Ub(8,"mat-card-subtitle"),c.Ac(9," We'll find the five closest food trucks to you in San Francisco! To start, enable access to your device location or click your current position in the map. "),c.Tb(),c.Ub(10,"mat-card-subtitle"),c.Ub(11,"strong"),c.Ac(12," The Reset button will set the map to Initial State. "),c.Tb(),c.Tb(),c.Ub(13,"mat-card-subtitle",4),c.Ub(14,"button",5),c.cc("click",(function(t){return e.reset()})),c.Ac(15," Reset "),c.Tb(),c.Ub(16,"button",6),c.cc("click",(function(t){return e.findMe()})),c.Ac(17," Find Me "),c.Tb(),c.Ub(18,"span",7),c.Ac(19),c.Tb(),c.yc(20,v,1,2,"mat-spinner",8),c.Tb(),c.Ub(21,"mat-card-content"),c.Ub(22,"agm-map",9),c.cc("zoomChange",(function(t){return e.zoom=t}))("mapClick",(function(t){return e.mapClicked(t)})),c.yc(23,O,2,1,"ng-container",10),c.gc(24,"async"),c.yc(25,U,1,6,"agm-circle",11),c.Tb(),c.Tb(),c.Tb(),c.yc(26,w,1,0,"div",12),c.Tb(),c.Tb(),c.Tb(),c.yc(27,M,2,3,"ng-template",null,13,c.zc)),2&t){const t=c.qc(28);c.Cb(1),c.kc("opened",e.sidenavOpen&&e.mediaObserver.isActive("gt-sm")),c.Cb(1),c.kc("ngIf",e.loading)("ngIfElse",t),c.Cb(17),c.Dc(" Latitude: ",e.lat,", Longitude: ",e.lng," "),c.Cb(1),c.kc("ngIf",e.loading),c.Cb(2),c.kc("latitude",e.lat)("longitude",e.lng)("zoom",e.zoom)("usePanning",!0)("clickableIcons",!1),c.Cb(1),c.kc("ngIf",c.hc(24,15,e.markers$)),c.Cb(2),c.kc("ngIf",e.radius),c.Cb(1),c.kc("ngIf",e.mediaObserver.isActive("lt-md"))("ngIfThen",t)}},directives:[u.b,u.a,g.k,u.c,f.a,f.f,f.e,p.b,k.a,f.c,h.d,C.b,g.j,h.e,h.c,h.a,f.b],pipes:[g.b],styles:["[_nghost-%COMP%]{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1}.page-container[_ngcontent-%COMP%]{margin:1em 0}agm-map[_ngcontent-%COMP%]{height:600px}.mat-progress-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}mat-drawer-container[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1}mat-drawer-container[_ngcontent-%COMP%]   mat-drawer.sidenav[_ngcontent-%COMP%]{width:300px}.sidenav[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin:.5em}"]}),t})();i.d(e,"HomeModule",(function(){return A}));let A=(()=>{class t{}return t.\u0275mod=c.Mb({type:t}),t.\u0275inj=c.Lb({factory:function(e){return new(e||t)},imports:[[a.a,n.c.forChild([{path:"",component:P}])]]}),t})()}}]);