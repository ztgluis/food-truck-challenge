!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"99Un":function(e,i,a){"use strict";a.r(i),a.d(i,"HomeModule",(function(){return $}));var c,r=a("tyNb"),o=a("M0ag"),l=a("fXoL"),s=a("tk/3"),d=((c=function(){function e(n){t(this,e),this.http=n,this.dataUrl="https://data.sfgov.org/resource/rqzj-sfat.json"}return n(e,[{key:"getFoodTruckData",value:function(t){return this.http.get(this.dataUrl,{params:t})}}]),e}()).\u0275fac=function(t){return new(t||c)(l.Vb(s.a))},c.\u0275prov=l.Hb({token:c,factory:c.\u0275fac,providedIn:"root"}),c),b=a("LRne"),u=a("UXun"),m=a("vkgz"),f=a("nYR2"),g=a("pD6V"),h=a("XhcP"),p=a("ofXK"),k=a("Wp6s"),v=a("bTqV"),y=a("Qu3c"),O=a("pxUr"),R=a("Xa2L");function C(t,e){1&t&&l.Mb(0,"mat-spinner",14),2&t&&l.hc("diameter",22)("strokeWidth",2)}function w(t,e){1&t&&l.Mb(0,"mat-spinner",15),2&t&&l.hc("diameter",22)("strokeWidth",2)}function Q(t,e){if(1&t){var n=l.Sb();l.Rb(0,"agm-marker",17),l.Zb("markerClick",(function(){l.pc(n);var t=e.$implicit;return l.cc(2).markerClicked(t)})),l.Rb(1,"agm-info-window",18),l.Rb(2,"strong"),l.zc(3),l.Qb(),l.Rb(4,"p"),l.zc(5),l.Qb(),l.Qb(),l.Qb()}if(2&t){var i=e.$implicit,a=l.cc(2);l.hc("latitude",i.latitude)("longitude",i.longitude)("label",i.label),l.Ab(1),l.hc("isOpen",a.infoWindow===i.objectid),l.Ab(2),l.Ac(i.applicant),l.Ab(2),l.Ac(i.address)}}function I(t,e){if(1&t&&(l.Pb(0),l.xc(1,Q,6,6,"agm-marker",16),l.Ob()),2&t){var n=e.ngIf;l.Ab(1),l.hc("ngForOf",n)}}function x(t,e){if(1&t&&l.Mb(0,"agm-circle",19),2&t){var n=l.cc();l.hc("latitude",n.lat)("longitude",n.lng)("radius",n.radius)("clickable",!1)("fillColor","blue")("fillOpacity",.2)}}function z(t,e){1&t&&l.Mb(0,"div")}function A(t,e){if(1&t){var n=l.Sb();l.Rb(0,"div",21),l.Rb(1,"div",22),l.Zb("click",(function(){l.pc(n);var t=e.$implicit;return l.cc(3).markerClicked(t)})),l.Rb(2,"mat-card"),l.Rb(3,"mat-card-title"),l.zc(4),l.Qb(),l.Rb(5,"mat-card-subtitle"),l.zc(6),l.Qb(),l.Rb(7,"mat-card-content"),l.Rb(8,"strong"),l.zc(9,"Distance:"),l.Qb(),l.zc(10),l.Qb(),l.Rb(11,"mat-card-actions"),l.Rb(12,"a",23),l.zc(13," Click for Directions "),l.Qb(),l.Qb(),l.Qb(),l.Qb(),l.Qb()}if(2&t){var i=e.$implicit,a=l.cc(3);l.Ab(1),l.Cb("p-2 ",i===a.selectedMarker?"bg-secondary":"",""),l.Ab(3),l.Cc(" ",i.label,") ",i.applicant," "),l.Ab(2),l.Bc(" ",i.address," "),l.Ab(4),l.Bc(" ",i.miles," miles "),l.Ab(2),l.ic("href","https://www.google.com/maps/dir/?api=1&origin=",a.lat,",",a.lng,"&destination=",i.latitude,",",i.longitude,"",l.qc)}}function M(t,e){if(1&t&&(l.Pb(0),l.xc(1,A,14,11,"div",20),l.Ob()),2&t){var n=e.ngIf;l.Ab(1),l.hc("ngForOf",n)}}function P(t,e){if(1&t&&(l.xc(0,M,2,1,"ng-container",10),l.dc(1,"async")),2&t){var n=l.cc();l.hc("ngIf",l.ec(1,1,n.markers$))}}var F,T,_=((T=function(){function e(n,i,a){t(this,e),this.mediaObserver=n,this.sfDataService=i,this.cdRef=a,this.mediaObserver$=this.mediaObserver.asObservable(),this.reset()}return n(e,[{key:"reset",value:function(){this.lat=37.75923216518026,this.lng=-122.42079955329393,this.zoom=12,this.radius=0,this.sidenavOpen=!1,this.markers$=Object(b.a)([])}},{key:"markerClicked",value:function(t){this.selectedMarker===t?(this.selectedMarker=null,this.infoWindow=null):(this.selectedMarker=t,this.infoWindow=t.objectid)}},{key:"mapClicked",value:function(t){this.selectedMarker=null,this.radius=0,this.lat=t.latLng.lat(),this.lng=t.latLng.lng(),this.findNearbyFoodTrucks()}},{key:"findMe",value:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){t.lat=e.coords.latitude,t.lng=e.coords.longitude,t.cdRef.detectChanges()})):alert("Geolocation is not supported by this browser.")}},{key:"findNearbyFoodTrucks",value:function(){var t=this;this.loading=!0,this.sidenavOpen=!0,this.markers$=this.sfDataService.getFoodTruckData({$order:"distance_in_meters(location, 'POINT (".concat(this.lng," ").concat(this.lat,")')"),$limit:5,$select:"*, distance_in_meters(location, 'POINT (".concat(this.lng," ").concat(this.lat,")') AS range")}).pipe(Object(u.a)(1),Object(m.a)((function(e){e.forEach((function(e,n){t.zoom=14,e.label=String.fromCharCode(65+n);var i=Number(e.range)+20;i>t.radius&&(t.radius=i),e.miles=(parseFloat(e.range)/1609.34).toFixed(3)}))})),Object(f.a)((function(){t.loading=!1})))}}]),e}()).\u0275fac=function(t){return new(t||T)(l.Lb(g.g),l.Lb(d),l.Lb(l.h))},T.\u0275cmp=l.Fb({type:T,selectors:[["ftc-home"]],decls:29,vars:17,consts:[["autosize","",1,"sidenav-container"],["mode","side",1,"sidenav",3,"opened"],["class","mx-auto my-5 d-block",3,"diameter","strokeWidth",4,"ngIf","ngIfElse"],[1,"page-container"],[1,""],["mat-raised-button","","color","primary","matTooltip","Reset map to Initial State",1,"mx-2",3,"click"],["mat-raised-button","","color","primary","matTooltip","Use location services to find your current location",1,"mx-2",3,"click"],[1,"mx-2"],["class","mx-2",3,"diameter","strokeWidth",4,"ngIf"],[3,"latitude","longitude","zoom","usePanning","clickableIcons","zoomChange","mapClick"],[4,"ngIf"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity",4,"ngIf"],[4,"ngIf","ngIfThen"],["markerTemplate",""],[1,"mx-auto","my-5","d-block",3,"diameter","strokeWidth"],[1,"mx-2",3,"diameter","strokeWidth"],[3,"latitude","longitude","label","markerClick",4,"ngFor","ngForOf"],[3,"latitude","longitude","label","markerClick"],[3,"isOpen"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity"],["class","sidenav",4,"ngFor","ngForOf"],[1,"sidenav"],[3,"click"],["target","_blank",1,"text-primary",3,"href"]],template:function(t,e){if(1&t&&(l.Rb(0,"mat-drawer-container",0),l.Rb(1,"mat-drawer",1),l.xc(2,C,1,2,"mat-spinner",2),l.Qb(),l.Rb(3,"mat-drawer-content"),l.Rb(4,"div",3),l.Rb(5,"mat-card"),l.Rb(6,"mat-card-title"),l.zc(7,"San Francisco Food Trucks"),l.Qb(),l.Rb(8,"mat-card-subtitle"),l.zc(9," We'll find the five closest food trucks to you in San Francisco! To start, enable access to your device location or click your current position in the map. "),l.Qb(),l.Rb(10,"mat-card-subtitle"),l.Rb(11,"strong"),l.zc(12," The Reset button will set the map to Initial State. "),l.Qb(),l.Qb(),l.Rb(13,"mat-card-subtitle",4),l.Rb(14,"button",5),l.Zb("click",(function(){return e.reset()})),l.zc(15," Reset "),l.Qb(),l.Rb(16,"button",6),l.Zb("click",(function(){return e.findMe()})),l.zc(17," Find Me "),l.Qb(),l.Rb(18,"span",7),l.zc(19),l.Qb(),l.xc(20,w,1,2,"mat-spinner",8),l.Qb(),l.Rb(21,"mat-card-content"),l.Rb(22,"agm-map",9),l.Zb("zoomChange",(function(t){return e.zoom=t}))("mapClick",(function(t){return e.mapClicked(t)})),l.xc(23,I,2,1,"ng-container",10),l.dc(24,"async"),l.xc(25,x,1,6,"agm-circle",11),l.Qb(),l.Qb(),l.Qb(),l.xc(26,z,1,0,"div",12),l.Qb(),l.Qb(),l.Qb(),l.xc(27,P,2,3,"ng-template",null,13,l.yc)),2&t){var n=l.nc(28);l.Ab(1),l.hc("opened",e.sidenavOpen&&e.mediaObserver.isActive("gt-sm")),l.Ab(1),l.hc("ngIf",e.loading)("ngIfElse",n),l.Ab(17),l.Cc(" Latitude: ",e.lat,", Longitude: ",e.lng," "),l.Ab(1),l.hc("ngIf",e.loading),l.Ab(2),l.hc("latitude",e.lat)("longitude",e.lng)("zoom",e.zoom)("usePanning",!0)("clickableIcons",!1),l.Ab(1),l.hc("ngIf",l.ec(24,15,e.markers$)),l.Ab(2),l.hc("ngIf",e.radius),l.Ab(1),l.hc("ngIf",e.mediaObserver.isActive("lt-md"))("ngIfThen",n)}},directives:[h.b,h.a,p.k,h.c,k.a,k.f,k.e,v.b,y.a,k.c,O.d,R.b,p.j,O.e,O.c,O.a,k.b],pipes:[p.b],styles:["[_nghost-%COMP%]{display:flex;flex:1}.page-container[_ngcontent-%COMP%]{margin:1em 0}agm-map[_ngcontent-%COMP%]{height:600px}.mat-progress-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}mat-drawer-container[_ngcontent-%COMP%]{flex:1}mat-drawer-container[_ngcontent-%COMP%]   mat-drawer.sidenav[_ngcontent-%COMP%]{width:300px}.sidenav[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin:.5em}"]}),T),$=((F=function e(){t(this,e)}).\u0275mod=l.Jb({type:F}),F.\u0275inj=l.Ib({factory:function(t){return new(t||F)},imports:[[o.a,r.c.forChild([{path:"",component:_}])]]}),F)}}])}();