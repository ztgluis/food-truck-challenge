function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{"99Un":function(t,e,i){"use strict";i.r(e);var n,a=i("tyNb"),c=i("M0ag"),r=i("fXoL"),o=i("tk/3"),l=((n=function(){function t(e){_classCallCheck(this,t),this.http=e,this.dataUrl="https://data.sfgov.org/resource/rqzj-sfat.json"}return _createClass(t,[{key:"getFoodTruckData",value:function(t){return this.http.get(this.dataUrl,{params:t})}}]),t}()).\u0275fac=function(t){return new(t||n)(r.Yb(o.a))},n.\u0275prov=r.Kb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),s=i("LRne"),d=i("UXun"),b=i("vkgz"),u=i("nYR2"),f=i("pD6V"),m=i("XhcP"),g=i("ofXK"),k=i("Wp6s"),p=i("bTqV"),h=i("Qu3c"),v=i("pxUr"),C=i("Xa2L");function y(t,e){1&t&&r.Pb(0,"mat-spinner",14),2&t&&r.kc("diameter",22)("strokeWidth",2)}function T(t,e){1&t&&r.Pb(0,"mat-spinner",15),2&t&&r.kc("diameter",22)("strokeWidth",2)}function O(t,e){if(1&t){var i=r.Vb();r.Ub(0,"agm-marker",17),r.cc("markerClick",(function(t){r.sc(i);var n=e.$implicit;return r.fc(2).markerClicked(n)})),r.Ub(1,"agm-info-window",18),r.Ub(2,"strong"),r.Ac(3),r.Tb(),r.Ub(4,"p"),r.Ac(5),r.Tb(),r.Tb(),r.Tb()}if(2&t){var n=e.$implicit,a=r.fc(2);r.kc("latitude",n.latitude)("longitude",n.longitude)("label",n.label),r.Cb(1),r.kc("isOpen",a.infoWindow===n.objectid),r.Cb(2),r.Bc(n.applicant),r.Cb(2),r.Bc(n.address)}}function U(t,e){if(1&t&&(r.Sb(0),r.yc(1,O,6,6,"agm-marker",16),r.Rb()),2&t){var i=e.ngIf;r.Cb(1),r.kc("ngForOf",i)}}function w(t,e){if(1&t&&r.Pb(0,"agm-circle",19),2&t){var i=r.fc();r.kc("latitude",i.lat)("longitude",i.lng)("radius",i.radius)("clickable",!1)("fillColor","blue")("fillOpacity",.2)}}function I(t,e){1&t&&r.Pb(0,"div")}function _(t,e){if(1&t){var i=r.Vb();r.Ub(0,"div",21),r.Ub(1,"div",22),r.cc("click",(function(t){r.sc(i);var n=e.$implicit;return r.fc(3).markerClicked(n)})),r.Ub(2,"mat-card"),r.Ub(3,"mat-card-title"),r.Ac(4),r.Tb(),r.Ub(5,"mat-card-subtitle"),r.Ac(6),r.Tb(),r.Ub(7,"mat-card-content"),r.Ub(8,"strong"),r.Ac(9,"Distance:"),r.Tb(),r.Ac(10),r.Tb(),r.Ub(11,"mat-card-actions"),r.Ub(12,"a",23),r.Ac(13," Click for Directions "),r.Tb(),r.Tb(),r.Tb(),r.Tb(),r.Tb()}if(2&t){var n=e.$implicit,a=r.fc(3);r.Cb(1),r.Eb("p-2 ",n===a.selectedMarker?"bg-secondary":"",""),r.Cb(3),r.Dc(" ",n.label,") ",n.applicant," "),r.Cb(2),r.Cc(" ",n.address," "),r.Cb(4),r.Cc(" ",n.miles," miles "),r.Cb(2),r.lc("href","https://www.google.com/maps/dir/?api=1&origin=",a.lat,",",a.lng,"&destination=",n.latitude,",",n.longitude,"",r.tc)}}function P(t,e){if(1&t&&(r.Sb(0),r.yc(1,_,14,11,"div",20),r.Rb()),2&t){var i=e.ngIf;r.Cb(1),r.kc("ngForOf",i)}}function x(t,e){if(1&t&&(r.yc(0,P,2,1,"ng-container",10),r.gc(1,"async")),2&t){var i=r.fc();r.kc("ngIf",r.hc(1,1,i.markers$))}}var M,A=((M=function(){function t(e,i,n){_classCallCheck(this,t),this.mediaObserver=e,this.sfDataService=i,this.cdRef=n,this.mediaObserver$=this.mediaObserver.asObservable(),this.reset()}return _createClass(t,[{key:"reset",value:function(){this.lat=37.75923216518026,this.lng=-122.42079955329393,this.zoom=12,this.radius=0,this.sidenavOpen=!1,this.markers$=Object(s.a)([])}},{key:"markerClicked",value:function(t){this.selectedMarker===t?(this.selectedMarker=null,this.infoWindow=null):(this.selectedMarker=t,this.infoWindow=t.objectid)}},{key:"mapClicked",value:function(t){this.selectedMarker=null,this.radius=0,this.lat=t.coords.lat,this.lng=t.coords.lng,this.findNearbyFoodTrucks()}},{key:"findMe",value:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){t.lat=e.coords.latitude,t.lng=e.coords.longitude,t.cdRef.detectChanges()})):alert("Geolocation is not supported by this browser.")}},{key:"findNearbyFoodTrucks",value:function(){var t=this;this.loading=!0,this.sidenavOpen=!0,this.markers$=this.sfDataService.getFoodTruckData({$order:"distance_in_meters(location, 'POINT (".concat(this.lng," ").concat(this.lat,")')"),$limit:5,$select:"*, distance_in_meters(location, 'POINT (".concat(this.lng," ").concat(this.lat,")') AS range")}).pipe(Object(d.a)(1),Object(b.a)((function(e){e.forEach((function(e,i){t.zoom=14,e.label=String.fromCharCode(65+i);var n=Number(e.range)+20;n>t.radius&&(t.radius=n),e.miles=(parseFloat(e.range)/1609.34).toFixed(3)}))})),Object(u.a)((function(){t.loading=!1})))}}]),t}()).\u0275fac=function(t){return new(t||M)(r.Ob(f.g),r.Ob(l),r.Ob(r.h))},M.\u0275cmp=r.Ib({type:M,selectors:[["ftc-home"]],decls:29,vars:17,consts:[["autosize","",1,"sidenav-container"],["mode","side",1,"sidenav",3,"opened"],["class","mx-auto my-5 d-block",3,"diameter","strokeWidth",4,"ngIf","ngIfElse"],[1,"page-container"],[1,""],["mat-raised-button","","color","primary","matTooltip","Reset map to Initial State",1,"mx-2",3,"click"],["mat-raised-button","","color","primary","matTooltip","Use location services to find your current location",1,"mx-2",3,"click"],[1,"mx-2"],["class","mx-2",3,"diameter","strokeWidth",4,"ngIf"],[3,"latitude","longitude","zoom","usePanning","clickableIcons","zoomChange","mapClick"],[4,"ngIf"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity",4,"ngIf"],[4,"ngIf","ngIfThen"],["markerTemplate",""],[1,"mx-auto","my-5","d-block",3,"diameter","strokeWidth"],[1,"mx-2",3,"diameter","strokeWidth"],[3,"latitude","longitude","label","markerClick",4,"ngFor","ngForOf"],[3,"latitude","longitude","label","markerClick"],[3,"isOpen"],[3,"latitude","longitude","radius","clickable","fillColor","fillOpacity"],["class","sidenav",4,"ngFor","ngForOf"],[1,"sidenav"],[3,"click"],["target","_blank",1,"text-primary",3,"href"]],template:function(t,e){if(1&t&&(r.Ub(0,"mat-drawer-container",0),r.Ub(1,"mat-drawer",1),r.yc(2,y,1,2,"mat-spinner",2),r.Tb(),r.Ub(3,"mat-drawer-content"),r.Ub(4,"div",3),r.Ub(5,"mat-card"),r.Ub(6,"mat-card-title"),r.Ac(7,"San Francisco Food Trucks"),r.Tb(),r.Ub(8,"mat-card-subtitle"),r.Ac(9," We'll find the five closest food trucks to you in San Francisco! To start, enable access to your device location or click your current position in the map. "),r.Tb(),r.Ub(10,"mat-card-subtitle"),r.Ub(11,"strong"),r.Ac(12," The Reset button will set the map to Initial State. "),r.Tb(),r.Tb(),r.Ub(13,"mat-card-subtitle",4),r.Ub(14,"button",5),r.cc("click",(function(t){return e.reset()})),r.Ac(15," Reset "),r.Tb(),r.Ub(16,"button",6),r.cc("click",(function(t){return e.findMe()})),r.Ac(17," Find Me "),r.Tb(),r.Ub(18,"span",7),r.Ac(19),r.Tb(),r.yc(20,T,1,2,"mat-spinner",8),r.Tb(),r.Ub(21,"mat-card-content"),r.Ub(22,"agm-map",9),r.cc("zoomChange",(function(t){return e.zoom=t}))("mapClick",(function(t){return e.mapClicked(t)})),r.yc(23,U,2,1,"ng-container",10),r.gc(24,"async"),r.yc(25,w,1,6,"agm-circle",11),r.Tb(),r.Tb(),r.Tb(),r.yc(26,I,1,0,"div",12),r.Tb(),r.Tb(),r.Tb(),r.yc(27,x,2,3,"ng-template",null,13,r.zc)),2&t){var i=r.qc(28);r.Cb(1),r.kc("opened",e.sidenavOpen&&e.mediaObserver.isActive("gt-sm")),r.Cb(1),r.kc("ngIf",e.loading)("ngIfElse",i),r.Cb(17),r.Dc(" Latitude: ",e.lat,", Longitude: ",e.lng," "),r.Cb(1),r.kc("ngIf",e.loading),r.Cb(2),r.kc("latitude",e.lat)("longitude",e.lng)("zoom",e.zoom)("usePanning",!0)("clickableIcons",!1),r.Cb(1),r.kc("ngIf",r.hc(24,15,e.markers$)),r.Cb(2),r.kc("ngIf",e.radius),r.Cb(1),r.kc("ngIf",e.mediaObserver.isActive("lt-md"))("ngIfThen",i)}},directives:[m.b,m.a,g.k,m.c,k.a,k.f,k.e,p.b,h.a,k.c,v.d,C.b,g.j,v.e,v.c,v.a,k.b],pipes:[g.b],styles:["[_nghost-%COMP%]{display:-webkit-box;display:flex;-webkit-box-flex:1;flex:1}.page-container[_ngcontent-%COMP%]{margin:1em 0}agm-map[_ngcontent-%COMP%]{height:600px}.mat-progress-spinner[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}mat-drawer-container[_ngcontent-%COMP%]{-webkit-box-flex:1;flex:1}mat-drawer-container[_ngcontent-%COMP%]   mat-drawer.sidenav[_ngcontent-%COMP%]{width:300px}.sidenav[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]{margin:.5em}"]}),M);i.d(e,"HomeModule",(function(){return z}));var F,z=((F=function t(){_classCallCheck(this,t)}).\u0275mod=r.Mb({type:F}),F.\u0275inj=r.Lb({factory:function(t){return new(t||F)},imports:[[c.a,a.c.forChild([{path:"",component:A}])]]}),F)}}]);